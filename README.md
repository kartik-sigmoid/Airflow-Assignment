# Airflow-Assignment

#### Problem statement: [Link](https://docs.google.com/document/d/1sRCD29lveSCLB2to1OX1EVgcjXg2VRWaXUx5gGeDizA/edit)

1. Graph view of DAG:
<img width="519" alt="image" src="https://user-images.githubusercontent.com/98140311/158321483-fdd495b5-9aa0-4f10-b1ca-1f9b8006ecb6.png">

2. Data fetching and adding to pandas dataframe with creation of table in postgres database:
<img width="745" alt="image" src="https://user-images.githubusercontent.com/98140311/158321688-57c71928-4e78-40f4-bd8a-a1050c2694bc.png">

3. Creation of CSV file in puckel/docker-airflow and adding fetched data from API into it:
<img width="834" alt="image" src="https://user-images.githubusercontent.com/98140311/158322264-4e67798d-c72e-4935-8598-479830e1055a.png">

4. Insertion of data from CSV file created into postgres table "weather":
<img width="914" alt="image" src="https://user-images.githubusercontent.com/98140311/158321779-7dbe5600-27e7-40e5-870e-b5232d7980a1.png">


